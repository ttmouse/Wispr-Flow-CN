# 热键状态显示功能使用指南

## 功能概述

在主界面标题栏的版本号后面，现在会显示一个圆点状态指示器，用于实时显示热键的工作状态。

## 状态指示器说明

### 状态颜色含义

- **🟢 绿色圆点**: 热键正常工作，处于待机状态
- **🟠 橙色圆点**: 热键正常工作，正在录音中
- **🔴 红色圆点**: 热键失效或出现问题
- **⚪ 灰色圆点**: 初始状态或检查中

### 详细状态信息

将鼠标悬停在状态指示器上，会显示详细的状态信息：

- **正常状态**: "热键状态：正常 (ctrl/fn/alt)"
- **录音状态**: "热键状态：录音中 (ctrl/fn/alt)"
- **失效状态**: "热键状态：失效 (ctrl/fn/alt) - 具体错误信息"
- **未初始化**: "热键状态：未初始化"
- **检查出错**: "热键状态：检查出错 - 错误详情"

## 功能特点

1. **实时监控**: 每2秒自动检查一次热键状态
2. **详细诊断**: 提供具体的错误信息，帮助诊断问题
3. **视觉反馈**: 通过颜色变化直观显示状态
4. **无干扰**: 状态指示器小巧，不影响正常使用

## 常见状态说明

### 正常工作状态
- 绿色圆点显示
- 热键监听器正常运行
- 可以正常进行语音录制

### 录音状态
- 橙色圆点显示
- 表示当前正在录音
- 松开热键后会自动转换为绿色

### 失效状态可能原因
- **监听器未运行**: 热键监听服务停止
- **Fn监听线程未运行**: 仅针对fn热键
- **权限问题**: 系统权限被撤销
- **系统冲突**: 与其他应用程序冲突

## 故障排除

### 当状态显示为红色时

1. **检查系统权限**
   - 打开系统偏好设置 → 安全性与隐私 → 辅助功能
   - 确保应用程序有辅助功能权限

2. **重启热键服务**
   - 在设置中切换热键类型
   - 或重启应用程序

3. **检查冲突应用**
   - 关闭其他可能占用热键的应用
   - 特别是其他语音输入或快捷键工具

### 状态检查异常

如果状态指示器显示"检查出错"，可能是：
- 应用程序内部错误
- 系统资源不足
- 建议重启应用程序

## 技术实现

### 新增功能

1. **HotkeyManager.get_status()**: 获取热键管理器状态
2. **MainWindow.update_hotkey_status()**: 更新UI状态显示
3. **定时器机制**: 每2秒自动检查状态

### 状态检查项目

- 键盘监听器运行状态
- Fn键监听线程状态（仅fn热键）
- 录音状态
- 热键类型

## 使用建议

1. **定期观察**: 注意状态指示器的颜色变化
2. **及时处理**: 发现红色状态时及时排查
3. **权限维护**: 定期检查系统权限设置
4. **日志查看**: 必要时查看控制台日志获取详细信息

## 更新日志

- 添加了实时热键状态监控
- 在主界面标题栏显示状态指示器
- 提供详细的状态信息和错误诊断
- 每2秒自动更新状态显示

这个功能帮助用户及时发现热键失效问题，提高使用体验和问题诊断效率。